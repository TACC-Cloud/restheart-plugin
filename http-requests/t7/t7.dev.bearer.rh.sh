#!/usr/bin/env bash

# testuser7
# client app: rsthrtapp key: k258KfoXvHLor0TyF310QNbria0a  secret: iGG8JW1m3i1ev22k265qvj65Ndwa
# forever token: a5ea10c768d3ad8d612bebf2405cfd

# export tok=a5ea10c768d3ad8d612bebf2405cfd
# export host=https://dev.tenants.aloedev.tacc.cloud
# export base=rh/v2

# simple list of metadata collection
# curl -X GET -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/metadata | jq # > result.json

# simple list of api db
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" "$base"/api | jq # > result.json


###################################################

# admin
# client app: test key: v3tiR9dgNUJOPHDyCVBN3zzQAc8a  secret: UqJ1uGuwYk1qkfYRiTk6pf_a_Xoa
# tmp token: feccf059b8072fe542b8e765c1d3f9

export tok=a5ea10c768d3ad8d612bebf2405cfd
export host=https://dev.tenants.aloedev.tacc.cloud
export base=rh/v2

# create our apim app for testing
# curl -sku "admin:Strangerinastrangel@nd" -X POST -d "clientName=rsthrtapp" -d "description=admin app used for testing rh admin functions" "$host"/clients/v2

# add subscription for our apim app for testing
# curl -sku "admin:Strangerinastrangel@nd" -X POST  -d "apiName=RestHeart&apiVersion=v2&apiProvider=admin" "$host"/clients/v2/rsthrtapp/subscriptions

# scurl -v -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/apiimple list of api db


# create a collection for large files
# curl -X PUT -H "Content-Type: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/mybucket.files

# add a large file to collection defaulting to MongoDB naming
# curl -X POST -H "Authorization : Bearer $tok" -F "file=@binary-data/jenkins-the-definitive-guide.pdf" "$host/$base"/api/mybucket.files

# simple list of api/mybucket.files
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/mybucket.files | jq

# using PUT to give large file a meaningful name
# curl -v -X PUT -H "Authorization : Bearer $tok" -F "file=@binary-data/jenkins-the-definitive-guide.pdf" "$host/$base"/api/mybucket.files/jenkins-the-definitive-guide.pdf | jq

# simple list of api/mybucket.files
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/mybucket.files/jenkins-the-definitive-guide.pdf | jq

# get the binary of a file /api/mybucket.files/jenkins-the-definitive-guide.pdf
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/mybucket.files/jenkins-the-definitive-guide.pdf/binary > tmp.pdf

# create a document in metadata collection   # s
# curl -v -X POST -H "Authorization : Bearer $tok" -H "Content-Type: application/json" -d "@document1.json" "$host/$base"/api/metadata

# get the document created in metadata
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" "$host/$base"/api/metadata/5d095783028ae24619924ea0 | jq


# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" https://dev.tenants.aloedev.tacc.cloud/rh/v2/v1public/rearrangement?filter=%7B%22filename_uuid%22%3A%7B%22%24in%22%3A%5B%221948223626708128231-242ac11c-0001-012%22%2C%224003519959228944871-242ac11c-0001-012%22%2C%22618590739453186536-242ac11c-0001-012%22%2C%224112542236705559016-242ac11c-0001-012%22%2C%22228498719656439320-242ac11c-0001-012%22%2C%225799996335674626536-242ac11c-0001-012%22%2C%224033258450224288231-242ac11c-0001-012%22%2C%224184909141241565671-242ac11c-0001-012%22%2C%225609034397249245671-242ac11c-0001-012%22%2C%22718414304763122151-242ac11c-0001-012%22%2C%226797709546090205671-242ac11c-0001-012%22%2C%226883137545118552551-242ac11c-0001-012%22%2C%227421212147472339431-242ac11c-0001-012%22%2C%222793798164965822951-242ac11c-0001-012%22%2C%221579330526434291225-242ac11c-0001-012%22%2C%222531606071098928665-242ac11c-0001-012%22%2C%228135350378552562151-242ac11c-0001-012%22%2C%224774237821721842151-242ac11c-0001-012%22%2C%222030956310420722151-242ac11c-0001-012%22%2C%227643474506018525671-242ac11c-0001-012%22%2C%221399495100277592551-242ac11c-0001-012%22%2C%227938145744078630425-242ac11c-0001-012%22%2C%222826183524049424871-242ac11c-0001-012%22%2C%221394485106826482151-242ac11c-0001-012%22%2C%228722753741409292776-242ac11c-0001-012%22%2C%22293362754747297305-242ac11c-0001-012%22%2C%226976913440255045145-242ac11c-0001-012%22%2C%221635382813071970791-242ac11c-0001-012%22%2C%222790340604725358105-242ac11c-0001-012%22%2C%226614953319037857305-242ac11c-0001-012%22%2C%22596856757474291225-242ac11c-0001-012%22%2C%225077093416066018840-242ac11c-0001-012%22%2C%227490867308604494311-242ac11c-0001-012%22%2C%227325296860612390425-242ac11c-0001-012%22%2C%224953493538860765671-242ac11c-0001-012%22%2C%226933014270285442585-242ac11c-0001-012%22%2C%228419526778125217305-242ac11c-0001-012%22%2C%226706274296562848231-242ac11c-0001-012%22%2C%225310786499607457305-242ac11c-0001-012%22%2C%222849748875730162151-242ac11c-0001-012%22%2C%221714309734955937305-242ac11c-0001-012%22%2C%226164974964043485671-242ac11c-0001-012%22%2C%223494100618393939480-242ac11c-0001-012%22%2C%222728737446246739480-242ac11c-0001-012%22%2C%221189861865604846056-242ac11c-0001-012%22%2C%225738267484920475160-242ac11c-0001-012%22%2C%223374231585856155160-242ac11c-0001-012%22%2C%228904775073569435160-242ac11c-0001-012%22%2C%222366080924918616551-242ac11c-0001-012%22%2C%221602908186092376551-242ac11c-0001-012%22%2C%221841923116114776551-242ac11c-0001-012%22%2C%222541616238306136551-242ac11c-0001-012%22%2C%222197374609531736551-242ac11c-0001-012%22%2C%221993707260355416551-242ac11c-0001-012%22%2C%223628844259615576551-242ac11c-0001-012%22%2C%223252733973504856551-242ac11c-0001-012%22%2C%222989624276951896551-242ac11c-0001-012%22%2C%222685411743376216551-242ac11c-0001-012%22%2C%222848663450297176551-242ac11c-0001-012%22%2C%223438706057421656551-242ac11c-0001-012%22%2C%224931851437876056551-242ac11c-0001-012%22%2C%224181735399629656551-242ac11c-0001-012%22%2C%223924638657291096551-242ac11c-0001-012%22%2C%224476756703191896551-242ac11c-0001-012%22%2C%224744762662462296551-242ac11c-0001-012%22%2C%224357957907784536551-242ac11c-0001-012%22%2C%226205695788196696551-242ac11c-0001-012%22%2C%226393557657723736551-242ac11c-0001-012%22%2C%225215877625160536551-242ac11c-0001-012%22%2C%227158276584776536551-242ac11c-0001-012%22%2C%225953881855632216551-242ac11c-0001-012%22%2C%225531257073705816551-242ac11c-0001-012%22%2C%226819446614795096551-242ac11c-0001-012%22%2C%227640859110155096551-242ac11c-0001-012%22%2C%227972301736387416551-242ac11c-0001-012%22%2C%227313153105470296551-242ac11c-0001-012%22%2C%227461458326201176551-242ac11c-0001-012%22%2C%226964444710708056551-242ac11c-0001-012%22%2C%228733756488295256551-242ac11c-0001-012%22%2C%227793588147200856551-242ac11c-0001-012%22%2C%228263242821018456551-242ac11c-0001-012%22%2C%228112833066312536551-242ac11c-0001-012%22%2C%228602072790999896551-242ac11c-0001-012%22%2C%228425807333172056551-242ac11c-0001-012%22%2C%227309695685264535065-242ac11c-0001-012%22%2C%227885350151947415065-242ac11c-0001-012%22%2C%228945756074025816551-242ac11c-0001-012%22%2C%228961797805343895065-242ac11c-0001-012%22%2C%229084118473933975065-242ac11c-0001-012%22%2C%228485700680582295065-242ac11c-0001-012%22%2C%226738379135550615065-242ac11c-0001-012%22%2C%225624006920930455065-242ac11c-0001-012%22%2C%227745763714827415065-242ac11c-0001-012%22%2C%227446748091679895065-242ac11c-0001-012%22%2C%227591789137265815065-242ac11c-0001-012%22%2C%227066128089908375065-242ac11c-0001-012%22%2C%226088937130722455065-242ac11c-0001-012%22%2C%226240077029868695065-242ac11c-0001-012%22%2C%226880327804683415065-242ac11c-0001-012%22%2C%226389112395039895065-242ac11c-0001-012%22%2C%225939858815878295065-242ac11c-0001-012%22%2C%226576544767837335065-242ac11c-0001-012%22%2C%225168912186246295065-242ac11c-0001-012%22%2C%225462430251254935065-242ac11c-0001-012%22%2C%225039977268020375065-242ac11c-0001-012%22%2C%224858300151399575065-242ac11c-0001-012%22%2C%225765010697258135065-242ac11c-0001-012%22%2C%225338391595746455065-242ac11c-0001-012%22%5D%7D%2C%22ir_cdr3_substrings%22%3A%22CASSP%22%7D

# curl -v  -H "Accept: application/json" -H "Authorization : Bearer $tok" https://dev.tenants.aloedev.tacc.cloud/rh/v2/v1public/rearrangement?filter=%7B%22filename_uuid%22%3A%7B%22%24in%22%3A%5B%221948223626708128231-242ac11c-0001-012%22%2C%224003519959228944871-242ac11c-0001-012%22%2C%22618590739453186536-242ac11c-0001-012%22%2C%224112542236705559016-242ac11c-0001-012%22%2C%22228498719656439320-242ac11c-0001-012%22%2C%225799996335674626536-242ac11c-0001-012%22%2C%224033258450224288231-242ac11c-0001-012%22%2C%224184909141241565671-242ac11c-0001-012%22%2C%225609034397249245671-242ac11c-0001-012%22%2C%22718414304763122151-242ac11c-0001-012%22%2C%226797709546090205671-242ac11c-0001-012%22%2C%226883137545118552551-242ac11c-0001-012%22%2C%227421212147472339431-242ac11c-0001-012%22%2C%222793798164965822951-242ac11c-0001-012%22%2C%221579330526434291225-242ac11c-0001-012%22%2C%222531606071098928665-242ac11c-0001-012%22%2C%228135350378552562151-242ac11c-0001-012%22%2C%224774237821721842151-242ac11c-0001-012%22%2C%222030956310420722151-242ac11c-0001-012%22%2C%227643474506018525671-242ac11c-0001-012%22%2C%221399495100277592551-242ac11c-0001-012%22%2C%227938145744078630425-242ac11c-0001-012%22%2C%222826183524049424871-242ac11c-0001-012%22%2C%221394485106826482151-242ac11c-0001-012%22%2C%228722753741409292776-242ac11c-0001-012%22%2C%22293362754747297305-242ac11c-0001-012%22%2C%226976913440255045145-242ac11c-0001-012%22%2C%221635382813071970791-242ac11c-0001-012%22%2C%222790340604725358105-242ac11c-0001-012%22%2C%226614953319037857305-242ac11c-0001-012%22%2C%22596856757474291225-242ac11c-0001-012%22%2C%225077093416066018840-242ac11c-0001-012%22%2C%227490867308604494311-242ac11c-0001-012%22%2C%227325296860612390425-242ac11c-0001-012%22%2C%224953493538860765671-242ac11c-0001-012%22%2C%226933014270285442585-242ac11c-0001-012%22%2C%228419526778125217305-242ac11c-0001-012%22%2C%226706274296562848231-242ac11c-0001-012%22%2C%225310786499607457305-242ac11c-0001-012%22%2C%222849748875730162151-242ac11c-0001-012%22%2C%221714309734955937305-242ac11c-0001-012%22%2C%226164974964043485671-242ac11c-0001-012%22%2C%223494100618393939480-242ac11c-0001-012%22%2C%222728737446246739480-242ac11c-0001-012%22%2C%221189861865604846056-242ac11c-0001-012%22%2C%225738267484920475160-242ac11c-0001-012%22%2C%223374231585856155160-242ac11c-0001-012%22%2C%228904775073569435160-242ac11c-0001-012%22%2C%222366080924918616551-242ac11c-0001-012%22%2C%221602908186092376551-242ac11c-0001-012%22%2C%221841923116114776551-242ac11c-0001-012%22%2C%222541616238306136551-242ac11c-0001-012%22%2C%222197374609531736551-242ac11c-0001-012%22%2C%221993707260355416551-242ac11c-0001-012%22%2C%223628844259615576551-242ac11c-0001-012%22%2C%223252733973504856551-242ac11c-0001-012%22%2C%222989624276951896551-242ac11c-0001-012%22%2C%222685411743376216551-242ac11c-0001-012%22%2C%222848663450297176551-242ac11c-0001-012%22%2C%223438706057421656551-242ac11c-0001-012%22%2C%224931851437876056551-242ac11c-0001-012%22%2C%224181735399629656551-242ac11c-0001-012%22%2C%223924638657291096551-242ac11c-0001-012%22%2C%224476756703191896551-242ac11c-0001-012%22%2C%224744762662462296551-242ac11c-0001-012%22%2C%224357957907784536551-242ac11c-0001-012%22%2C%226205695788196696551-242ac11c-0001-012%22%2C%226393557657723736551-242ac11c-0001-012%22%2C%225215877625160536551-242ac11c-0001-012%22%2C%227158276584776536551-242ac11c-0001-012%22%2C%225953881855632216551-242ac11c-0001-012%22%2C%225531257073705816551-242ac11c-0001-012%22%2C%226819446614795096551-242ac11c-0001-012%22%2C%227640859110155096551-242ac11c-0001-012%22%2C%227972301736387416551-242ac11c-0001-012%22%2C%227313153105470296551-242ac11c-0001-012%22%2C%227461458326201176551-242ac11c-0001-012%22%2C%226964444710708056551-242ac11c-0001-012%22%2C%228733756488295256551-242ac11c-0001-012%22%2C%227793588147200856551-242ac11c-0001-012%22%2C%228263242821018456551-242ac11c-0001-012%22%2C%228112833066312536551-242ac11c-0001-012%22%2C%228602072790999896551-242ac11c-0001-012%22%2C%228425807333172056551-242ac11c-0001-012%22%2C%227309695685264535065-242ac11c-0001-012%22%2C%227885350151947415065-242ac11c-0001-012%22%2C%228945756074025816551-242ac11c-0001-012%22%2C%228961797805343895065-242ac11c-0001-012%22%2C%229084118473933975065-242ac11c-0001-012%22%2C%228485700680582295065-242ac11c-0001-012%22%2C%226738379135550615065-242ac11c-0001-012%22%2C%225624006920930455065-242ac11c-0001-012%22%2C%227745763714827415065-242ac11c-0001-012%22%2C%227446748091679895065-242ac11c-0001-012%22%2C%227591789137265815065-242ac11c-0001-012%22%2C%227066128089908375065-242ac11c-0001-012%22%2C%226088937130722455065-242ac11c-0001-012%22%2C%226240077029868695065-242ac11c-0001-012%22%2C%226880327804683415065-242ac11c-0001-012%22%2C%226389112395039895065-242ac11c-0001-012%22%2C%225939858815878295065-242ac11c-0001-012%22%2C%226576544767837335065-242ac11c-0001-012%22%2C%225168912186246295065-242ac11c-0001-012%22%2C%225462430251254935065-242ac11c-0001-012%22%2C%225039977268020375065-242ac11c-0001-012%22%2C%224858300151399575065-242ac11c-0001-012%22%2C%225765010697258135065-242ac11c-0001-012%22%2C%225338391595746455065-242ac11c-0001-012%22%5D%7D%2C%22ir_cdr3_substrings%22%3A%22CASSP%22%7D

# curl  -H "Accept: application/json" -H "Authorization : Bearer $tok" https://dev.tenants.aloedev.tacc.cloud/rh/v2/v1public/query?pagesize=1000 | jq

i="1"
#while [ $i -lt 1001 ]; do

# echo curl  -H "Accept: application/json" -H "Authorization : Bearer $tok" https://dev.tenants.aloedev.tacc.cloud/rh/v2/v1public/rearrangement?page="${i}"\&pagesize=1000\&np
# curl -H "Accept: application/json" -H "Authorization : Bearer $tok" https://dev.tenants.aloedev.tacc.cloud/rh/v2/v1public/rearrangement?page="${i}"\&pagesize=1000\&np | jq  >> result.json
# echo; echo on page $i; echo
# let i=i+1

# done